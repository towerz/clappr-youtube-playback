!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("Clappr")):"function"==typeof define&&define.amd?define(["Clappr"],t):"object"==typeof exports?exports.YoutubePlayback=t(require("Clappr")):e.YoutubePlayback=t(e.Clappr)}(this,function(e){return function(e){function t(r){if(i[r])return i[r].exports;var n=i[r]={exports:{},id:r,loaded:!1};return e[r].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var i={};return t.m=e,t.c=i,t.p="<%=baseUrl%>/",t(0)}([function(e,t,i){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),o=function(e,t,i){for(var r=!0;r;){var n=e,a=t,s=i;r=!1,null===n&&(n=Function.prototype);var o=Object.getOwnPropertyDescriptor(n,a);if(void 0!==o){if("value"in o)return o.value;var u=o.get;if(void 0===u)return;return u.call(s)}var l=Object.getPrototypeOf(n);if(null===l)return;e=l,t=a,i=s,r=!0,o=l=void 0}},u=i(1),l=i(2),p=r(l),y=i(4),h=r(y),c=function(e){function t(e){n(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.settings={changeCount:0,seekEnabled:!0,left:["playpause","position","duration"],default:["seekbar"],right:["fullscreen","volume","hd-indicator"]},u.Mediator.on(u.Events.PLAYER_RESIZE,this.updateSize,this),this.embedYoutubeApiScript()}return a(t,e),s(t,[{key:"name",get:function(){return"youtube_playback"}},{key:"template",get:function(){return(0,u.template)(h.default)}},{key:"attributes",get:function(){return{"data-youtube-playback":"",class:"clappr-youtube-playback",id:this.cid}}},{key:"ended",get:function(){return!1}},{key:"buffering",get:function(){return this.player&&this.player.getPlayerState()===YT.PlayerState.BUFFERING}},{key:"isReady",get:function(){return this._ready}}]),s(t,[{key:"setupYoutubePlayer",value:function(){var e=this;window.YT&&window.YT.Player?this.embedYoutubePlayer():this.once(u.Events.PLAYBACK_READY,function(){return e.embedYoutubePlayer()})}},{key:"embedYoutubeApiScript",value:function(){var e=this,t=document.createElement("script");t.setAttribute("type","text/javascript"),t.setAttribute("async","async"),t.setAttribute("src","https://www.youtube.com/iframe_api"),document.body.appendChild(t),window.onYouTubeIframeAPIReady=function(){return e.ready()}}},{key:"embedYoutubePlayer",value:function(){var e=this,t={controls:0,autoplay:1,disablekb:1,enablejsapi:1,iv_load_policy:3,modestbranding:1,showinfo:0,html5:1};this.options.youtubePlaylist&&(t.listType="playlist",t.list=this.options.youtubePlaylist),this.player=new YT.Player("yt"+this.cid,{videoId:this.options.src,playerVars:t,events:{onReady:function(){return e.ready()},onStateChange:function(t){return e.stateChange(t)},onPlaybackQualityChange:function(t){return e.qualityChange(t)}}})}},{key:"updateSize",value:function(){var e=0===this.$el.width()?this.options.width:this.$el.width(),t=0===this.$el.width()?this.options.height:this.$el.height();this.player&&this.player.setSize(e,t)}},{key:"ready",value:function(){var e=this;this._ready=!0,(0,u.$)(window).resize(function(){setTimeout(e.updateSize(),500)}),(0,u.$)(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",setTimeout(this.updateSize(),500)),this.trigger(u.Events.PLAYBACK_READY)}},{key:"qualityChange",value:function(e){this.trigger(u.Events.PLAYBACK_HIGHDEFINITIONUPDATE,this.isHighDefinitionInUse())}},{key:"stateChange",value:function(e){switch(e.data){case YT.PlayerState.PLAYING:this.enableMediaControl();var t=this.getPlaybackType();this._playbackType!==t&&(this.settings.changeCount++,this._playbackType=t,this.trigger(u.Events.PLAYBACK_SETTINGSUPDATE)),this.trigger(u.Events.PLAYBACK_BUFFERFULL),this.trigger(u.Events.PLAYBACK_PLAY);break;case YT.PlayerState.PAUSED:this.trigger(u.Events.PLAYBACK_PAUSE);break;case YT.PlayerState.BUFFERING:this.trigger(u.Events.PLAYBACK_BUFFERING);break;case YT.PlayerState.ENDED:this.options.youtubeShowRelated?this.disableMediaControl():this.trigger(u.Events.PLAYBACK_ENDED)}}},{key:"play",value:function(){var e=this;this.player?(this._progressTimer=this._progressTimer||setInterval(function(){return e.progress()},100),this._timeupdateTimer=this._timeupdateTimer||setInterval(function(){return e.timeupdate()},100),this.player.playVideo()):this._ready?(this.trigger(u.Events.PLAYBACK_BUFFERING),this._progressTimer=this._progressTimer||setInterval(function(){return e.progress()},100),this._timeupdateTimer=this._timeupdateTimer||setInterval(function(){return e.timeupdate()},100),this.setupYoutubePlayer()):(this.trigger(u.Events.PLAYBACK_BUFFERING),this.listenToOnce(this,u.Events.PLAYBACK_READY,this.play))}},{key:"pause",value:function(){clearInterval(this._timeupdateTimer),this._timeupdateTimer=null,this.player&&this.player.pauseVideo()}},{key:"seek",value:function(e){this.player&&this.player.seekTo(e)}},{key:"seekPercentage",value:function(e){if(this.player){var t=this.player.getDuration(),i=e*t/100;this.seekTo(i)}}},{key:"volume",value:function(e){this.player&&this.player.setVolume&&this.player.setVolume(e)}},{key:"progress",value:function(){if(this.player&&this.player.getDuration){var e=this.player.getDuration()*this.player.getVideoLoadedFraction();this.trigger(u.Events.PLAYBACK_PROGRESS,{start:0,current:e,total:this.player.getDuration()})}}},{key:"timeupdate",value:function(){this.player&&this.player.getDuration&&this.trigger(u.Events.PLAYBACK_TIMEUPDATE,{current:this.player.getCurrentTime(),total:this.player.getDuration()})}},{key:"isPlaying",value:function(){return this.player&&this.player.getPlayerState()==YT.PlayerState.PLAYING}},{key:"isHighDefinitionInUse",value:function(){return this.player&&!!this.player.getPlaybackQuality().match(/^hd\d+/)}},{key:"getDuration",value:function(){var e=0;return this.player&&(e=this.player.getDuration()),e}},{key:"getPlaybackType",value:function(){return u.Playback.VOD}},{key:"disableMediaControl",value:function(){this.$el.css({"pointer-events":"auto"}),this.trigger(u.Events.PLAYBACK_MEDIACONTROL_DISABLE)}},{key:"enableMediaControl",value:function(){this.$el.css({"pointer-events":"none"}),this.trigger(u.Events.PLAYBACK_MEDIACONTROL_ENABLE)}},{key:"render",value:function(){this.$el.html(this.template({id:"yt"+this.cid}));var e=u.Styler.getStyleFor(p.default,{baseUrl:this.options.baseUrl});return this.$el.append(e),this}}]),t}(u.Playback);t.default=c,c.canPlay=function(e){return!0},e.exports=t.default},function(t,i){t.exports=e},function(e,t,i){t=e.exports=i(3)(),t.push([e.id,".clappr-youtube-playback[data-youtube-playback]{position:absolute;height:100%;width:100%;display:block;pointer-events:none}",""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var i=this[t];i[2]?e.push("@media "+i[2]+"{"+i[1]+"}"):e.push(i[1])}return e.join("")},e.i=function(t,i){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},n=0;n<this.length;n++){var a=this[n][0];"number"==typeof a&&(r[a]=!0)}for(n=0;n<t.length;n++){var s=t[n];"number"==typeof s[0]&&r[s[0]]||(i&&!s[2]?s[2]=i:i&&(s[2]="("+s[2]+") and ("+i+")"),e.push(s))}},e}},function(e,t){e.exports='<div id="<%=id%>"></div>'}])});
//# sourceMappingURL=youtube_playback.min.js.map